<script src="{% static 'js/handlebars.min.js' %}"></script>
<script src="{% static 'js/list.min.js' %}"></script>





cirlce message coming code

         <li>
            <div class="message-data">
              <span class="message-data-name"><i class="fa fa-circle online"></i> Vincent</span>
              <span class="message-data-time">10:31 AM, Today</span>
            </div>
            <i class="fa fa-circle online"></i>
            <i class="fa fa-circle online" style="color: #AED2A6"></i>
            <i class="fa fa-circle online" style="color:#DAE9DA"></i>
          </li>
          style = "opacity: 0.5;background: #CCC;pointer-events:none;"


          <li class="clearfix">
            <div class="about">
              <div class="name">Status</div>
              <div class="status">
                <i class="fa fa-spinner fa-pulse" style= "color:white;"></i>&nbsp Searching for partner
              </div>
            </div>
          </li>

          <li class="clearfix">
            <div class="about">
              <div class="name">Status</div>
              <div class="status">
                <i class="fa fa-circle offline"></i>&nbsp Partner left
              </div>
            </div>
          </li>

          <li class="clearfix">
            <div class="about">
              <div class="name">Status</div>
              <div class="status">
                <i class="fa fa-circle online"></i>&nbsp Connected
              </div>
            </div>
          </li>



          <button type="button" class="btn btn-danger">New chat</button>


<script src="{% static 'js/jquery.min.js' %}"></script>
<script src="{% static 'js/handlebars.min.js' %}"></script>
<script src="{% static 'js/list.min.js' %}"></script>

<script src="{% static 'js/index.js' %}"></script>

<script src="{% static 'js/index.js' %}"></script>




$('.stopsearch').on('click', function(event){
// clearInterval(refreshTimer);
// $(".stopsearch, .searchingforpartner, .partnerleft, .connected, .newchat, .esfnp").addClass("hide");
// $(".startchat, .notconnected").removeClass("hide");
gettime()
});

function gettime() {
    var dt = new Date()
   var hours = dt.getHours();
   var minutes  = dt.getMinutes();
    var hours = (hours+24-2)%24; 
    var mid='AM';
    if(hours==0){ //At 00 hours we need to show 12 am
    hours=12;
    }
    else if(hours>12)
    {
    hours=hours%12;
    mid='PM';
    }
    alert (hours +':' minutes + ' '+ mid);       
}


$('.stopsearch').on('click', function(event){

var dt = new Date();
var time = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
alert(time)

});



          <li class="clearfix">
            <div class="message-data align-right" >
              <span class="message-data-time" >10:10 AM, Today</span> &nbsp; &nbsp;
              <span class="message-data-name" >Olia</span> <i class="fa fa-circle me"></i>
              
            </div>
            <div class="message  other-message float-right">
              Hi Vincent, how are you? How is the project coming along?
            </div>
          </li>
          

          
          <li>
            <div class="message-data">
              <span class="message-data-name"><i class="fa fa-circle online"></i> Vincent</span>
              <span class="message-data-time">10:20 AM, Today</span>
            </div>
            <div class="message my-message">
              Actually everything was fine. I'm very excited to show this to our team.
            </div>
          </li>


































var refreshTimer = 0;
$('.startchat, .esfnp, .newchat').on('click', function(event){

    $(".chat-history").addClass("disabled");
    $(".sendbutton").addClass("unactive");
    document.getElementById("message-to-send").value = "";
    $("textarea").attr("disabled","disabled");
    $("#messages").empty();
    clearInterval(refreshTimer);

    $.ajax({
        url : "connect",
        type : "GET",
        success : function(data){
        $(".partnerleft, .connected, .notconnected, .startchat, .newchat, .esfnp").addClass("hide");
        $(".stopsearch,  .searchingforpartner").removeClass("hide");
        $("#session").removeClass();
        $("#session").addClass(data.session_id);
        refreshTimer = setInterval(getMessages, 2000);
        }
    });

});

$('.stopsearch').on('click', function(event){

clearInterval(refreshTimer);
$(".stopsearch, .searchingforpartner, .partnerleft, .connected, .newchat, .esfnp").addClass("hide");
$(".startchat, .notconnected").removeClass("hide");

    $.ajax({
        url : "stop",
        type : "GET",
        data: {sess:  $('#session').attr('class')},
        success : function(data){

        }
    });


});


$('.testing1').on('click', function(event){



});

function gettime() {
    var dt = new Date()
    var hours = dt.getHours();
    var minutes  = dt.getMinutes();
    var hours = (hours+24)%24; 
    var mid='AM';
    if(hours==0){ //At 00 hours we need to show 12 am
    hours=12;
    }
    else if(hours>12)
    {
    hours=hours%12;
    mid='PM';
    }
    return(hours +':' +minutes + ' '+ mid);       
}


$('#sendbutton').on('click', function(event){

        var message = $('#message-to-send').val().trim();
        if (message !== '')
        {

    $.ajax({
        url : "/send/",
        type : "GET",
        data : { msgbox : message, session : $('#session').attr('class') },
        dataType: "json",
        success : function(data){
                var newhtml =  '<li class="clearfix">\
                <div class="message-data align-right" >\
                <span class="message-data-time" >' + gettime() +', Today</span> &nbsp; &nbsp;\
                <span class="message-data-name" >You</span> <i class="fa fa-circle me"></i>\
                </div><div class="message other-message float-right">' +    message +    '</div></li>';
                $('#messages').append(newhtml); 
                $('#message-to-send').val('');

                element = $("#messages")[0];
                $('.chat-history').animate({scrollTop: element.scrollHeight});     
        }
    });
    }
});



$("#message-to-send").keyup(function(event){
    if(event.keyCode == 13){
        $("#sendbutton").click();
    }
});

function getMessages(){
    var session = $('#session').attr('class')
                        
        $.ajax({
                type: "GET",
                url:"/check/",
                dataType: "json",
                data: {sess: session},
                success: function(data) 
                { 
                
                 if (data.flag==0 || data.flag ==1)
                 {
                    $(".stopsearch, .searchingforpartner, .partnerleft, .notconnected, .startchat, .newchat").addClass("hide");
                    $(".connected, .esfnp").removeClass("hide");
                    $(".chat-history").removeClass("disabled");
                    $(".sendbutton").removeClass("unactive");
                    $("textarea").removeAttr("disabled");
                    if (data.flag == 0)
                    {
                    var newhtml = '<li>\
                        <div class="message-data">\
                        <span class="message-data-name"><i class="fa fa-circle online"></i> Anonymous</span>\
                        <span class="message-data-time">'+ gettime() +', Today</span></div>\
                        <div class="message my-message">' + data.message + '</div></li>';
                        $('#messages').append(newhtml); 
                        $('#message-to-send').val('');
                        element = $("#messages")[0];
                        $('.chat-history').animate({scrollTop: element.scrollHeight});     

                    }

                 }

                 else if (data.flag == 2)
                 {
                    $(".stopsearch, .searchingforpartner, .connected, .notconnected, .startchat, .esfnp").addClass("hide");
                    $(".partnerleft, .newchat").removeClass("hide");
                    $(".chat-history").addClass("disabled");
                    $(".sendbutton").addClass("unactive");
                    document.getElementById("message-to-send").value = "";
                    $("textarea").attr("disabled","disabled");
                    clearInterval(refreshTimer);
                 }
                 else
                 {

                 }

                 },
                error: function(data) 
                {                               
                                   
               }
            });
}


// 0 means sucessfully get the message and you are now connected
// 1 no messages yet and now you are connected
// 2 partner is offline now and not connected
//3 not connected yet 


function getOnline(){
    $.ajax({
        url : "/count/",
        type : "GET",
        dataType: "json",
        success : function(data){
             var newhtml = '<i class="fa fa-circle online"></i> online : ' + data.online
             $( ".totalonline" ).empty();
            $('.totalonline').append(newhtml); 
        }
    });

    }
setInterval(getOnline, 5000);

















clearInterval(refreshTimer);
$(".stopsearch, .searchingforpartner, .partnerleft, .connected, .newchat, .esfnp").addClass("hide");
$(".startchat, .notconnected").removeClass("hide");
    $.ajax({
        url : "stop",
        type : "GET",
        data: {sess:  $('#session').attr('class')},
        success : function(data){
        }
    });
});


$('.testing1').on('click', function(event){
});

function gettime() {
    var dt = new Date()
    var hours = dt.getHours();
    var minutes  = dt.getMinutes();
    var hours = (hours+24)%24; 
    var mid='AM';
    if(hours==0){ //At 00 hours we need to show 12 am
    hours=12;
    }
    else if(hours>12)
    {
    hours=hours%12;
    mid='PM';
    }
    return(hours +':' +minutes + ' '+ mid);       
}


$('#sendbutton').on('click', function(event){
        var message = $('#message-to-send').val().trim();
        if (message !== '')
        {
    $.ajax({
        url : "/send/",
        type : "GET",
        data : { msgbox : message, session : $('#session').attr('class') },
        dataType: "json",
        success : function(data){
                var newhtml =  '<li class="clearfix">\
                <div class="message-data align-right" >\
                <span class="message-data-time" >' + gettime() +', Today</span> &nbsp; &nbsp;\
                <span class="message-data-name" >You</span> <i class="fa fa-circle me"></i>\
                </div><div class="message other-message float-right">' +    message +    '</div></li>';
                $('#messages').append(newhtml); 
                $('#message-to-send').val('');

                element = $("#messages")[0];
                $('.chat-history').animate({scrollTop: element.scrollHeight});     
        }
    });
    }
});



$("#message-to-send").keyup(function(event){
    if(event.keyCode == 13){
        $("#sendbutton").click();
    }
});

function getMessages(){
    var session = $('#session').attr('class')
                        
        $.ajax({
                type: "GET",
                url:"/check/",
                dataType: "json",
                data: {sess: session},
                success: function(data) 
                { 
                 if (data.flag==0 || data.flag ==1)
                 {
                    $(".stopsearch, .searchingforpartner, .partnerleft, .notconnected, .startchat, .newchat").addClass("hide");
                    $(".connected, .esfnp").removeClass("hide");
                    $(".chat-history").removeClass("disabled");
                    $(".sendbutton").removeClass("unactive");
                    $("textarea").removeAttr("disabled");
                    if (data.flag == 0)
                    {
                    var newhtml = '<li>\
                        <div class="message-data">\
                        <span class="message-data-name"><i class="fa fa-circle online"></i> Anonymous</span>\
                        <span class="message-data-time">'+ gettime() +', Today</span></div>\
                        <div class="message my-message">' + data.message + '</div></li>';
                        $('#messages').append(newhtml); 
                        $('#message-to-send').val('');
                        element = $("#messages")[0];
                        $('.chat-history').animate({scrollTop: element.scrollHeight});     
                    }
                 }

                 else if (data.flag == 2)
                 {
                    $(".stopsearch, .searchingforpartner, .connected, .notconnected, .startchat, .esfnp").addClass("hide");
                    $(".partnerleft, .newchat").removeClass("hide");
                    $(".chat-history").addClass("disabled");
                    $(".sendbutton").addClass("unactive");
                    document.getElementById("message-to-send").value = "";
                    $("textarea").attr("disabled","disabled");
                    clearInterval(refreshTimer);
                 }
                 else
                 {
                 }
                 },
                error: function(data) 
                {                                                    
               }
            });
}



function getOnline(){
    $.ajax({
        url : "/count/",
        type : "GET",
        dataType: "json",
        success : function(data){
             var newhtml = '<i class="fa fa-circle online"></i> online : ' + data.online
             $( ".totalonline" ).empty();
            $('.totalonline').append(newhtml); 
        }
    });
    }
setInterval(getOnline, 5000);

















jquery code comreedresd and withour errir


00000000000000000000000000000000000000000

var refreshTimer = 0;
var firsttime = 0;
$('.startchat, .esfnp, .newchat').on('click', function(event){
    $(".chat-history").addClass("disabled");
    $(".sendbutton").addClass("unactive");
    document.getElementById("message-to-send").value = "";
    $("textarea").attr("disabled","disabled");
    $("#messages").empty();
    clearInterval(refreshTimer);
    $.ajax({
        url : "connect",
        type : "GET",
        success : function(data){

            $(".partnerleft, .connected, .notconnected, .startchat, .newchat, .esfnp").addClass("hide");
            $(".stopsearch,  .searchingforpartner").removeClass("hide");
            $("#session").removeClass();
            $("#session").addClass(data.session_id);
            refreshTimer = setInterval(getMessages, 2000);
        }
    });
});

$('.stopsearch').on('click', function(event){
clearInterval(refreshTimer);
$(".stopsearch, .searchingforpartner, .partnerleft, .connected, .newchat, .esfnp").addClass("hide");
$(".startchat, .notconnected").removeClass("hide");
$.ajax({
url : "stop",
type : "GET",
data: {sess:  $('#session').attr('class')},
success : function(data){
}
});
});


function gettime() {
var dt = new Date();
var hours = dt.getHours();
var minutes  = dt.getMinutes();
var hours = (hours+24)%24; 
var mid='AM';
if(hours==0){ //At 00 hours we need to show 12 am
hours=12;
}
else if(hours>12)
{
hours=hours%12;
mid='PM';
}
return(hours +':' +minutes + ' '+ mid);       
}





$('#sendbutton').on('click', function(event){
    var message = $('#message-to-send').val().trim();
    if (message !== '')
    {
        $.ajax({
            url : "/send/",
            type : "GET",
            data : { msgbox : message, session : $('#session').attr('class') },
            dataType: "json",
            success : function(data){
                var newhtml =  '<li class="clearfix">\
                <div class="message-data align-right" >\
                <span class="message-data-time" >' + gettime() +', Today</span> &nbsp; &nbsp;\
                <span class="message-data-name" >You</span> <i class="fa fa-circle me"></i>\
                </div><div class="message other-message float-right">' +    message +    '</div></li>';
                $('#messages').append(newhtml); 
                $('#message-to-send').val('');

                element = $("#messages")[0];
                $('.chat-history').animate({scrollTop: element.scrollHeight});     
            }
        });
    }
});



$("#message-to-send").keyup(function(event){
    if(event.keyCode == 13){
        $("#sendbutton").click();
    }
});

function getMessages(){
    var session = $('#session').attr('class');

    $.ajax({
        type: "GET",
        url:"/check/",
        dataType: "json",
        data: {sess: session},
        success: function(data) 
        { 
            if (data.flag==0 || data.flag ==1)
            {
                $(".stopsearch, .searchingforpartner, .partnerleft, .notconnected, .startchat, .newchat").addClass("hide");
                $(".connected, .esfnp").removeClass("hide");
                $(".chat-history").removeClass("disabled");
                $(".sendbutton").removeClass("unactive");
                $("textarea").removeAttr("disabled");
                if (firsttime == 0)
                {
                        toastr.clear();
                        toastr.options.positionClass = 'toast-top-right';
                        toastr.options.preventDuplicates = 'true';
                        toastr.success("You're now chatting with a random stranger. Say hi!");
                        firsttime = 1
                }

                if (data.flag == 0)
                {
                    var newhtml = '<li>\
                    <div class="message-data">\
                    <span class="message-data-name"><i class="fa fa-circle online"></i> Anonymous</span>\
                    <span class="message-data-time">'+ gettime() +', Today</span></div>\
                    <div class="message my-message">' + data.message + '</div></li>';
                    $('#messages').append(newhtml); 
                    $('#message-to-send').val('');
                    element = $("#messages")[0];
                    $('.chat-history').animate({scrollTop: element.scrollHeight});     
                }
            }

            else if (data.flag == 2)
            {
                $(".stopsearch, .searchingforpartner, .connected, .notconnected, .startchat, .esfnp").addClass("hide");
                $(".partnerleft, .newchat").removeClass("hide");
                $(".chat-history").addClass("disabled");
                $(".sendbutton").addClass("unactive");
                document.getElementById("message-to-send").value = "";
                $("textarea").attr("disabled","disabled");
                clearInterval(refreshTimer);
                firsttime = 0
                toastr.clear();
                toastr.options.positionClass = 'toast-top-right';
                toastr.options.preventDuplicates = 'true';
                toastr.info("Partner left");
            }
            else
            {}
        },
        error: function(data) 
        {                                                    
        }
    });
}


function getOnline(){
    $.ajax({
    url : "/count/",
    type : "GET",
    dataType: "json",
    success : function(data){
        var newhtml = '<i class="fa fa-circle online"></i> online : ' + data.online;
        $( ".totalonline" ).empty();
        $('.totalonline').append(newhtml); 
    }
    });
}
setInterval(getOnline, 5000);




// 0 means sucessfully get the message and you are now connected
// 1 no messages yet and now you are connected
// 2 partner is offline now and not connected
//3 not connected yet 



var refreshTimer = 0;
var firsttime = 0;
$('.startchat, .esfnp, .newchat').on('click', function(event){
    firsttime = 0
    $(".chat-history").addClass("disabled");
    $(".sendbutton").addClass("unactive");
    document.getElementById("message-to-send").value = "";
    $("textarea").attr("disabled","disabled");
    $("#messages").empty();
    clearInterval(refreshTimer);
    $.ajax({
        url : "connect",
        type : "GET",
        success : function(data){

            $(".partnerleft, .connected, .notconnected, .startchat, .newchat, .esfnp").addClass("hide");
            $(".stopsearch,  .searchingforpartner").removeClass("hide");
            $("#session").removeClass();
            $("#session").addClass(data.session_id);
            refreshTimer = setInterval(getMessages, 2000);
        },error: function(data) 
            {           toastr.clear();
                        toastr.options.positionClass = 'toast-top-right';
                        toastr.options.preventDuplicates = 'true';
                        toastr.error("Something went wrong");                                                
            }
    });
});

$('.stopsearch').on('click', function(event){
    clearInterval(refreshTimer);
    $(".stopsearch, .searchingforpartner, .partnerleft, .connected, .newchat, .esfnp").addClass("hide");
    $(".startchat, .notconnected").removeClass("hide");
    $.ajax({
        url : "stop",
        type : "GET",
        data: {sess:  $('#session').attr('class')},
        success : function(data){
        }
    });
});


function gettime() {
var dt = new Date();
var hours = dt.getHours();
var minutes  = dt.getMinutes();
var hours = (hours+24)%24; 
var mid='AM';
if(hours==0){ //At 00 hours we need to show 12 am
hours=12;
}
else if(hours>12)
{
hours=hours%12;
mid='PM';
}
return(hours +':' +minutes + ' '+ mid);       
}





$('#sendbutton').on('click', function(event){
    var message = $('#message-to-send').val().trim();
    if (message !== '')
    {
        $.ajax({
            url : "/send/",
            type : "GET",
            data : { msgbox : message, session : $('#session').attr('class') },
            dataType: "json",
            success : function(data){
                var newhtml =  '<li class="clearfix">\
                <div class="message-data align-right" >\
                <span class="message-data-time" >' + gettime() +', Today</span> &nbsp; &nbsp;\
                <span class="message-data-name" >You</span> <i class="fa fa-circle me"></i>\
                </div><div class="message other-message float-right">' +    message +    '</div></li>';
                $('#messages').append(newhtml); 
                $('#message-to-send').val('');

                element = $("#messages")[0];
                $('.chat-history').animate({scrollTop: element.scrollHeight});     
            },        
            error: function(data) 
            {           toastr.clear();
                        toastr.options.positionClass = 'toast-top-right';
                        toastr.options.preventDuplicates = 'true';
                        toastr.error("Something went wrong");                                                
            }
        });
    }
});



$("#message-to-send").keyup(function(event){
    if(event.keyCode == 13){
        $("#sendbutton").click();
    }
});

function getMessages(){
    var session = $('#session').attr('class');

    $.ajax({
        type: "GET",
        url:"/check/",
        dataType: "json",
        data: {sess: session},
        success: function(data) 
        { 
            if (data.flag==0 || data.flag ==1)
            {
                $(".stopsearch, .searchingforpartner, .partnerleft, .notconnected, .startchat, .newchat").addClass("hide");
                $(".connected, .esfnp").removeClass("hide");
                $(".chat-history").removeClass("disabled");
                $(".sendbutton").removeClass("unactive");
                $("textarea").removeAttr("disabled");
                if (firsttime == 0)
                {
                        toastr.clear();
                        toastr.options.positionClass = 'toast-top-right';
                        toastr.options.preventDuplicates = 'true';
                        toastr.success("You're now chatting with a random stranger. Say hi!");
                        firsttime = 1
                }

                if (data.flag == 0)
                {
                    var newhtml = '<li>\
                    <div class="message-data">\
                    <span class="message-data-name"><i class="fa fa-circle online"></i> Anonymous</span>\
                    <span class="message-data-time">'+ gettime() +', Today</span></div>\
                    <div class="message my-message">' + data.message + '</div></li>';
                    $('#messages').append(newhtml); 
                    $('#message-to-send').val('');
                    element = $("#messages")[0];
                    $('.chat-history').animate({scrollTop: element.scrollHeight});     
                }
            }

            else if (data.flag == 2)
            {
                $(".stopsearch, .searchingforpartner, .connected, .notconnected, .startchat, .esfnp").addClass("hide");
                $(".partnerleft, .newchat").removeClass("hide");
                $(".chat-history").addClass("disabled");
                $(".sendbutton").addClass("unactive");
                document.getElementById("message-to-send").value = "";
                $("textarea").attr("disabled","disabled");
                clearInterval(refreshTimer);
                if (firsttime == 1)
                {
                    firsttime = 0
                    toastr.clear();
                    toastr.options.positionClass = 'toast-top-right';
                    toastr.options.preventDuplicates = 'true';
                    toastr.info("Partner left");
                }
            }
            else
            {}
        },
        error: function(data) 
        {                                                    
        }
    });
}


function getOnline(){
    $.ajax({
    url : "/count/",
    type : "GET",
    dataType: "json",
    success : function(data){
        var newhtml = '<i class="fa fa-circle online"></i> online : ' + data.online;
        $( ".totalonline" ).empty();
        $('.totalonline').append(newhtml); 
    }
    });
}
setInterval(getOnline, 5000);




// 0 means sucessfully get the message and you are now connected
// 1 no messages yet and now you are connected
// 2 partner is offline now and not connected
//3 not connected yet 
